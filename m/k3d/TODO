curl -sSL -o headlamp.yaml https://raw.githubusercontent.com/headlamp-k8s/headlamp/main/kubernetes-headlamp.yaml
curl -sSL -o argocd.yaml https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
trunk fmt

kubectl create namespace argocd
kubectl apply -n argocd -f argocd.yaml

kubectl apply -f headlamp.yaml
kubectl -n kube-system create serviceaccount headlamp-admin
kubectl create clusterrolebinding headlamp-admin --serviceaccount=kube-system:headlamp-admin --clusterrole=cluster-admin

kubectl delete -n argocd cm argocd-cmd-params-cm
kubectl create configmap argocd-cmd-params-cm -n argocd --from-literal=server.insecure=false -o yaml | kubectl apply -f - -n argocd
kubectl rollout restart deployment argocd-server -n argocd

open http://localhost:6665
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d | code -c

open http://localhost:6655
kubectl create token headlamp-admin -n kube-system | code -c
