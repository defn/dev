#ManagedBy: cue

patches:
  - path: patch-service-mastodon-apache.yaml
  - path: patch-job-mastodon-init.yaml
namespace: mastodon
commonLabels: {}
commonAnnotations: {}
resources:
  - resource-namespace.yaml
  - resource-ingress-mastodon-apache.yaml
  - resource-externalsecret-default.yaml
  - resource-externalsecret-smtp.yaml
  - resource-externalsecret-minio.yaml
  - resource-externalsecret-postgresql.yaml
  - resource-externalsecret-redis.yaml
helmCharts:
  - releaseName: mastodon
    namespace: mastodon
    valuesInline:
      initJob:
        createAdmin: true
      adminUser: defn
      adminEmail: iam@defn.sh
      webDomain: mastodon.district.amanibhavam.defn.run
      useSecureWebSocket: true
      existingSecret: mastodon-default
      smtp:
        existingSecret: mastodon-smtp
      redis:
        auth:
          existingSecret: mastodon-redis
      postgresql:
        auth:
          existingSecret: mastodon-postgresql
      minio:
        auth:
          existingSecret: mastodon-minio
    name: mastodon
    version: 3.2.5
    repo: https://charts.bitnami.com/bitnami
    includeCRDs: true
