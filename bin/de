#!/usr/bin/env bash

if [[ -n "${1:-}" ]]; then
    chdir="$1"; shift
else
    chdir=.
fi

cd "$chdir"
direnv allow

if [[ -n "${1:-}" ]]; then
    eval "$(~/.nix-profile/bin/direnv hook bash)"
    _direnv_hook
    exec "$@"
else
    code-server .
fi