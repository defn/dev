#!/usr/bin/env bash

function main {
	set -efu

	case "${1:-}" in
		sync|get|wait|terminate-op|resources|logs|diff)
			if [[ -n "${2:-}" ]]; then
				exec argocd --core app "$@" "$(app list | tail -n +2 | awk '{print $1}' | fzf --select-1)"
			else
				exec argocd --core app "$@"
			fi
			;;
		*)
			exec argocd --core app "$@"
			;;
	esac
}

main "$@"
